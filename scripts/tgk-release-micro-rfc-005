#!/usr/bin/env bash
# micro-rfc-005 release command

echo "ğŸš€ micro-rfc-005 RELEASE"
echo "========================"
echo ""

# Set environment variables
export CLOUDFLARE_API_TOKEN=WE66D-oXqNm2kbpSi3SgQdXmXNpphUbZMulvYvrO
export STAGE="prod"
export PROFILE="prod"

echo "ğŸ“‹ Release Configuration:"
echo "   Stage: $STAGE"
echo "   Profile: $PROFILE"
echo "   Token: ${CLOUDFLARE_API_TOKEN:0:10}..."
echo ""

echo "ğŸ—ï¸ Executing: ./tgk release micro-rfc-005 --stage prod --profile prod"
echo ""

# Execute the complete release script
./scripts/tgk-release-complete --stage prod --profile prod

# Check exit code
if [ $? -eq 0 ]; then
    echo ""
    echo "âœ… EXIT 0 â†’ PRODUCTION LIVE"
    echo "ğŸ¯ micro-rfc-005 is now live in production!"
    echo "ğŸ“Š Thread-safe webhook processing active"
    echo "ğŸ”— Durable Object instances: gh_agent_forum-polish, gh_agent_mobile-app"
else
    echo ""
    echo "âŒ Release failed - exit code: $?"
    echo "ğŸ“ Check logs above for troubleshooting"
fi
